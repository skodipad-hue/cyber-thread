<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Feed</title>

<script src="https://cdn.tailwindcss.com"></script>

<script>
tailwind.config = {
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        twitterBg: "#f5f9fc",
        twitterCard: "#ffffff",
        twitterBorder: "#e5eff6",
        twitterBlue: "#1d9bf0",
        twitterHover: "#e8f3ff",
        twitterText: "#0f172a",
        twitterMuted: "#64748b",

        darkBg: "#0f1419",
        darkCard: "#161b22",
        darkBorder: "#232a31",
        darkText: "#e6edf3",
        darkMuted: "#8b949e"
      }
    }
  }
}
</script>
</head>

<body class="bg-twitterBg text-twitterText dark:bg-darkBg dark:text-darkText font-sans antialiased min-h-screen">

<!-- HEADER -->
<header class="bg-white dark:bg-darkBg border-b border-twitterBorder dark:border-darkBorder">
  <div
    class="max-w-7xl mx-auto
           px-[18px] sm:px-6
           py-[22px] sm:py-4
           flex flex-col gap-[18px]
           sm:flex-row sm:items-center sm:justify-between">

    <!-- LOGOUT (MOBILE BIG) -->
    <a href="/login"
       class="self-start sm:self-auto
              px-[22px] py-[14px]
              sm:px-4 sm:py-2
              text-[16px] sm:text-sm
              bg-red-500 text-white
              rounded-full font-semibold
              hover:bg-red-400 transition">
      Logout
    </a>

    <!-- CENTER -->
    <div class="flex items-center justify-center gap-[14px]">
      <h1 class="text-[28px] sm:text-xl font-bold text-twitterBlue uppercase tracking-wide">
        CYBER THREADS
      </h1>

      <button id="themeToggle"
        class="p-[10px] sm:p-2 rounded-full
               hover:bg-twitterHover
               dark:hover:bg-white/10
               transition">
        <span id="sun" class="text-[22px] sm:text-lg">‚òÄÔ∏è</span>
        <span id="moon" class="text-[22px] sm:text-lg hidden">üåô</span>
      </button>
    </div>

    <!-- PROFILE (MOBILE BIG) -->
    <a href="/profile/<%= userId %>"
       class="self-end sm:self-auto
              px-[22px] py-[14px]
              sm:px-4 sm:py-2
              text-[16px] sm:text-sm
              bg-twitterBlue text-white
              rounded-full font-semibold
              hover:bg-[#1a8cd8]
              transition">
      Profile
    </a>

  </div>
</header>

<!-- FEED -->
<section
  class="max-w-7xl mx-auto mt-[18px]
         px-[18px] sm:px-6
         pb-20
         flex flex-wrap
         gap-[18px] sm:gap-6
         justify-start items-start">

  <% if (!posts || posts.length === 0) { %>
    <p class="w-full text-center text-twitterMuted dark:text-darkMuted text-[16px]">
      No posts yet.
    </p>
  <% } %>

  <% posts.forEach(post => { %>

  <!-- POST CARD (ONE PER ROW ON PHONE) -->
  <div class="w-full sm:w-[48%] lg:w-[31%]">

    <div
      class="bg-twitterCard dark:bg-darkCard
             border border-twitterBorder dark:border-darkBorder
             rounded-[18px]
             shadow-sm hover:shadow-md transition">

      <a href="/posts/<%= post.id %>" class="block w-full text-left">

        <!-- POST HEADER -->
        <div class="flex justify-between items-start px-[18px] pt-[16px] pb-[10px]">
          <h3 class="font-semibold text-[17px] sm:text-sm">
            @<%= post.username %>
          </h3>
          <small class="text-twitterMuted dark:text-darkMuted text-[13px] whitespace-nowrap">
            <%= post.timeAgo %>
          </small>
        </div>

        <!-- POST CONTENT -->
        <div class="px-[18px] pb-[18px] pt-[6px]">
          <p class="text-[18px] sm:text-[15px]
                    leading-[26px] sm:leading-relaxed
                    break-words">
            <%= post.content %>
          </p>
        </div>

      </a>

    </div>

  </div>

  <% }) %>

</section>

<!-- THEME TOGGLE SCRIPT -->
<script>
  const html = document.documentElement;
  const toggle = document.getElementById("themeToggle");
  const sun = document.getElementById("sun");
  const moon = document.getElementById("moon");

  if (localStorage.theme === "dark") {
    html.classList.add("dark");
    sun.classList.add("hidden");
    moon.classList.remove("hidden");
  }

  toggle.onclick = () => {
    const isDark = html.classList.toggle("dark");
    sun.classList.toggle("hidden", isDark);
    moon.classList.toggle("hidden", !isDark);
    localStorage.theme = isDark ? "dark" : "light";
  };
</script>

</body>
</html>
